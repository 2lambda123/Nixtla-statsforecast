---

title: Title


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/arima.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/arima.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>[ ] KalmanLike</li>
<li>[ ] KalmanSmooth</li>
<li>[x] KalmanFore</li>
<li>[x] partrans</li>
<li>[x] ARIMA_undoPars</li>
<li>[x] ARIMA_transPars</li>
<li>[x] invpartrans</li>
<li>[x] ARIMA_Invtrans</li>
<li>[x] ARIMA_Gradtrans</li>
<li>[x] ARIMA_Like</li>
<li>[x] ARIMA_CSS</li>
<li>[x] TSconv</li>
<li>[x] inclu2</li>
<li>[ ] getQ0bis</li>
<li>[x] getQ0</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">])</span>
<span class="n">arma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">expected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mf">0.9899673</span><span class="p">,</span> <span class="mf">0.8553135</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">arima_gradtrans</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">arma</span><span class="p">),</span> <span class="n">expected</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">expected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.09966799</span><span class="p">,</span> <span class="mf">0.37994896</span><span class="p">,</span> <span class="mf">1.00000000</span><span class="p">,</span> <span class="mf">3.10000000</span><span class="p">])</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">arima_undopars</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">arma</span><span class="p">),</span> <span class="n">expected</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tsconv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([  1.,   4.,  10.,  20.,  35.,  56.,  84., 120., 165., 220., 264.,
       296., 315., 320., 310., 284., 241., 180., 100.])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">expected_tsconv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">264</span><span class="p">,</span>
    <span class="mi">296</span><span class="p">,</span> <span class="mi">315</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">284</span><span class="p">,</span> <span class="mi">241</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">100</span>
<span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">expected_tsconv</span><span class="p">,</span> <span class="n">tsconv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">])</span>
<span class="n">arma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ARIMA_invtrans</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">arma</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.1, 0.4, 1. , 3.1])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">expected_getQ0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
       <span class="p">[</span> <span class="o">-</span><span class="mf">3.07619732</span><span class="p">,</span>   <span class="mf">1.11465544</span><span class="p">,</span>   <span class="mf">2.11357369</span><span class="p">,</span>   <span class="mf">3.15204201</span><span class="p">,</span>
          <span class="mf">4.19013718</span><span class="p">,</span>   <span class="mf">5.22823588</span><span class="p">,</span>   <span class="mf">6.26633453</span><span class="p">,</span>   <span class="mf">7.30443355</span><span class="p">,</span>
          <span class="mf">8.34249459</span><span class="p">,</span>   <span class="mf">9.38458115</span><span class="p">,</span>  <span class="mf">10.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">1.11465544</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.22931088</span><span class="p">,</span>   <span class="mf">1.92416552</span><span class="p">,</span>   <span class="mf">2.84615733</span><span class="p">,</span>
          <span class="mf">3.80807237</span><span class="p">,</span>   <span class="mf">4.76961073</span><span class="p">,</span>   <span class="mf">5.73115265</span><span class="p">,</span>   <span class="mf">6.69269418</span><span class="p">,</span>
          <span class="mf">7.65427405</span><span class="p">,</span>   <span class="mf">8.61179041</span><span class="p">,</span>  <span class="mf">10.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">2.11357369</span><span class="p">,</span>   <span class="mf">1.92416552</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.37881633</span><span class="p">,</span>   <span class="mf">5.73654439</span><span class="p">,</span>
          <span class="mf">7.62116681</span><span class="p">,</span>   <span class="mf">9.54570541</span><span class="p">,</span>  <span class="mf">11.46986742</span><span class="p">,</span>  <span class="mf">13.39403227</span><span class="p">,</span>
         <span class="mf">15.31827268</span><span class="p">,</span>  <span class="mf">17.23450038</span><span class="p">,</span>  <span class="mf">20.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">3.15204201</span><span class="p">,</span>   <span class="mf">2.84615733</span><span class="p">,</span>   <span class="mf">5.73654439</span><span class="p">,</span>   <span class="mf">4.39470753</span><span class="p">,</span>
         <span class="mf">11.47233269</span><span class="p">,</span>  <span class="mf">14.31920899</span><span class="p">,</span>  <span class="mf">17.20600158</span><span class="p">,</span>  <span class="mf">20.0924165</span> <span class="p">,</span>
         <span class="mf">22.9789482</span> <span class="p">,</span>  <span class="mf">25.85347889</span><span class="p">,</span>  <span class="mf">30.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">4.19013718</span><span class="p">,</span>   <span class="mf">3.80807237</span><span class="p">,</span>   <span class="mf">7.62116681</span><span class="p">,</span>  <span class="mf">11.47233269</span><span class="p">,</span>
         <span class="mf">11.09276725</span><span class="p">,</span>  <span class="mf">19.13264974</span><span class="p">,</span>  <span class="mf">22.94178352</span><span class="p">,</span>  <span class="mf">26.79083216</span><span class="p">,</span>
         <span class="mf">30.63965504</span><span class="p">,</span>  <span class="mf">34.47249261</span><span class="p">,</span>  <span class="mf">40.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">5.22823588</span><span class="p">,</span>   <span class="mf">4.76961073</span><span class="p">,</span>   <span class="mf">9.54570541</span><span class="p">,</span>  <span class="mf">14.31920899</span><span class="p">,</span>
         <span class="mf">19.13264974</span><span class="p">,</span>  <span class="mf">19.71534157</span><span class="p">,</span>  <span class="mf">28.71748151</span><span class="p">,</span>  <span class="mf">33.48887095</span><span class="p">,</span>
         <span class="mf">38.30036514</span><span class="p">,</span>  <span class="mf">43.09150596</span><span class="p">,</span>  <span class="mf">50.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">6.26633453</span><span class="p">,</span>   <span class="mf">5.73115265</span><span class="p">,</span>  <span class="mf">11.46986742</span><span class="p">,</span>  <span class="mf">17.20600158</span><span class="p">,</span>
         <span class="mf">22.94178352</span><span class="p">,</span>  <span class="mf">28.71748151</span><span class="p">,</span>  <span class="mf">30.2624308</span> <span class="p">,</span>  <span class="mf">40.22682604</span><span class="p">,</span>
         <span class="mf">45.96069867</span><span class="p">,</span>  <span class="mf">51.71052289</span><span class="p">,</span>  <span class="mf">60.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">7.30443355</span><span class="p">,</span>   <span class="mf">6.69269418</span><span class="p">,</span>  <span class="mf">13.39403227</span><span class="p">,</span>  <span class="mf">20.0924165</span> <span class="p">,</span>
         <span class="mf">26.79083216</span><span class="p">,</span>  <span class="mf">33.48887095</span><span class="p">,</span>  <span class="mf">40.22682604</span><span class="p">,</span>  <span class="mf">42.73402992</span><span class="p">,</span>
         <span class="mf">53.66094562</span><span class="p">,</span>  <span class="mf">60.32916003</span><span class="p">,</span>  <span class="mf">70.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">8.34249459</span><span class="p">,</span>   <span class="mf">7.65427405</span><span class="p">,</span>  <span class="mf">15.31827268</span><span class="p">,</span>  <span class="mf">22.9789482</span> <span class="p">,</span>
         <span class="mf">30.63965504</span><span class="p">,</span>  <span class="mf">38.30036514</span><span class="p">,</span>  <span class="mf">45.96069867</span><span class="p">,</span>  <span class="mf">53.66094562</span><span class="p">,</span>
         <span class="mf">57.13074521</span><span class="p">,</span>  <span class="mf">68.98805242</span><span class="p">,</span>  <span class="mf">80.</span>        <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">9.38458115</span><span class="p">,</span>   <span class="mf">8.61179041</span><span class="p">,</span>  <span class="mf">17.23450038</span><span class="p">,</span>  <span class="mf">25.85347889</span><span class="p">,</span>
         <span class="mf">34.47249261</span><span class="p">,</span>  <span class="mf">43.09150596</span><span class="p">,</span>  <span class="mf">51.71052289</span><span class="p">,</span>  <span class="mf">60.32916003</span><span class="p">,</span>
         <span class="mf">68.98805242</span><span class="p">,</span>  <span class="mf">73.38026771</span><span class="p">,</span>  <span class="mf">90.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">10.</span>        <span class="p">,</span>  <span class="mf">10.</span>        <span class="p">,</span>  <span class="mf">20.</span>        <span class="p">,</span>  <span class="mf">30.</span>        <span class="p">,</span>
         <span class="mf">40.</span>        <span class="p">,</span>  <span class="mf">50.</span>        <span class="p">,</span>  <span class="mf">60.</span>        <span class="p">,</span>  <span class="mf">70.</span>        <span class="p">,</span>
         <span class="mf">80.</span>        <span class="p">,</span>  <span class="mf">90.</span>        <span class="p">,</span> <span class="mf">100.</span>        <span class="p">]]</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">expected_getQ0</span><span class="p">,</span> <span class="n">getQ0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>armaCSS<ul>
<li>ARIMA_transPars<ul>
<li>fixed, params narma + ncxreg</li>
<li>mask = is.na(fixed)</li>
<li>coef = as.double(fixed)</li>
<li>arma &lt;- as.integer(c(order[-2L], seasonal$order[-2L], seasonal$period,
<pre><code>           order[2L], seasonal$order[2L]))
</code></pre>
narma &lt;- sum(arma[1L:4L])</li>
</ul>
</li>
<li>ARIMA_CSS</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">par</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.26377432</span><span class="p">,</span>  <span class="mf">0.82436223</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.51341576</span><span class="p">])</span>
<span class="n">arma</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">expected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2748562</span><span class="p">,</span> <span class="mf">0.6774372</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5134158</span><span class="p">])</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">arima_transpar</span><span class="p">(</span><span class="n">par</span><span class="p">,</span> <span class="n">arma</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">actual</span><span class="p">,</span> <span class="n">exp</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
    <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">exp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">expected_arima_transpar_f</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.5</span> <span class="p">,</span>  <span class="mf">1.</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span>  <span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">]),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span> <span class="p">,</span> <span class="mf">1.</span>  <span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">arma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
<span class="k">for</span> <span class="n">exp</span><span class="p">,</span> <span class="n">calc</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">expected_arima_transpar_f</span><span class="p">,</span> <span class="n">arima_transpar</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">arma</span><span class="p">,</span> <span class="kc">False</span><span class="p">)):</span>
    <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">calc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">arima_css</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> 
          <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span>
          <span class="n">expected_arima_transpar_f</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
          <span class="n">expected_arima_transpar_f</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
          <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(0.18831307547433035,
 array([ 0.        ,  0.        ,  0.        ,  0.75      , -0.125     ,
        -0.6875    ,  0.28125   ,  0.015625  , -0.2109375 ,  0.37890625]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.68065055</span><span class="p">,</span> <span class="mf">0.24123847</span><span class="p">])</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.09653952</span><span class="p">])</span>
<span class="n">Delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">])</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">make_arima</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">Delta</span><span class="p">)</span>
<span class="n">res</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[ 0.68065055,  1.        ,  0.        ,  0.        ,  0.        ],
       [ 0.24123847,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 1.        ,  0.        ,  1.        , -0.        , -0.        ],
       [ 0.        ,  0.        ,  1.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  1.        ,  0.        ]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;Pn&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[ 1.27814998e+00, -1.16857328e+00,  0.00000000e+00],
       [-1.16857328e+00,  1.27678213e+00,  0.00000000e+00],
       [ 0.00000000e+00,  0.00000000e+00,  1.00000000e+06],
       [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
       [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;V&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[ 1.        , -1.09653952,  0.        ,  0.        ,  0.        ],
       [-1.09653952,  1.20239892, -0.        , -0.        , -0.        ],
       [ 0.        , -0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        , -0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        , -0.        ,  0.        ,  0.        ,  0.        ]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.99551517</span><span class="p">])</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">Pn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mf">5.32878591e+02</span><span class="p">,</span> <span class="mf">0.00000000e+00</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.00000000e+00</span><span class="p">,</span> <span class="mf">1.00000000e+06</span><span class="p">],</span>
<span class="p">])</span>
<span class="n">up</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">use_resid</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">arima_like</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">Pn</span><span class="p">,</span> <span class="n">up</span><span class="p">,</span> <span class="n">use_resid</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(0.002051882527695168,
 6.270663806368853,
 9,
 array([0.        , 0.04348532, 0.00448483, 0.00448483, 0.00448483,
        0.00448483, 0.00448483, 0.00448483, 0.00448483, 0.00448483]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(9,)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(9, 1)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">order</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">seasonal</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ap</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([112., 118., 132., 129., 121., 135., 148., 148., 136., 119., 104.,
       118., 115., 126., 141., 135., 125., 149., 170., 170., 158., 133.,
       114., 140., 145., 150., 178., 163., 172., 178., 199., 199., 184.,
       162., 146., 166., 171., 180., 193., 181., 183., 218., 230., 242.,
       209., 191., 172., 194., 196., 196., 236., 235., 229., 243., 264.,
       272., 237., 211., 180., 201., 204., 188., 235., 227., 234., 264.,
       302., 293., 259., 229., 203., 229., 242., 233., 267., 269., 270.,
       315., 364., 347., 312., 274., 237., 278., 284., 277., 317., 313.,
       318., 374., 413., 405., 355., 306., 271., 306., 315., 301., 356.,
       348., 355., 422., 465., 467., 404., 347., 305., 336., 340., 318.,
       362., 348., 363., 435., 491., 505., 404., 359., 310., 337., 360.,
       342., 406., 396., 420., 472., 548., 559., 463., 407., 362., 405.,
       417., 391., 419., 461., 472., 535., 622., 606., 508., 461., 390.,
       432.])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">arima</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">seasonal</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;CSS-ML&#39;</span><span class="p">)</span>
<span class="o">%</span><span class="k">time</span> res = arima(ap, order, seasonal, method=&#39;CSS-ML&#39;)
<span class="n">res</span><span class="p">[</span><span class="s1">&#39;arma&#39;</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;coef&#39;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;var_coef&#39;</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 58.9 ms, sys: 765 µs, total: 59.6 ms
Wall time: 59.6 ms
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((2, 1, 0, 0, 12, 1, 1),
 1020.5368509068375,
 {&#39;ar1&#39;: 0.48073625746683835,
  &#39;ar2&#39;: 0.21426406017010302,
  &#39;ma1&#39;: -1.0943650272563021},
 array([0.00375043, 0.00728157, 0.00763359]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res_intercept</span> <span class="o">=</span> <span class="n">arima</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">{</span><span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">},</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;CSS-ML&#39;</span><span class="p">)</span>
<span class="o">%</span><span class="k">time</span> res_intercept = arima(ap, (2, 0, 1), {&#39;order&#39;: (0, 0, 0), &#39;period&#39;: 12}, method=&#39;CSS-ML&#39;)
<span class="n">res_intercept</span><span class="p">[</span><span class="s1">&#39;arma&#39;</span><span class="p">],</span> <span class="n">res_intercept</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">],</span> <span class="n">res_intercept</span><span class="p">[</span><span class="s1">&#39;coef&#39;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">res_intercept</span><span class="p">[</span><span class="s1">&#39;var_coef&#39;</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 28.3 ms, sys: 79 µs, total: 28.4 ms
Wall time: 28.4 ms
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((2, 1, 0, 0, 12, 0, 0),
 1408.2492234121164,
 {&#39;ar1&#39;: 0.4990751323228189,
  &#39;ar2&#39;: 0.43135866302738013,
  &#39;ma1&#39;: 1.1676028455360214,
  &#39;intercept&#39;: 281.7476655208123},
 array([3.05578012e-02, 6.24270219e-02, 8.01603449e-02, 3.03148148e+03]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kalman_forecast</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">][</span><span class="n">var</span><span class="p">]</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([448.00309168, 423.71325894, 453.39311702, 496.56711308,
        508.49142877, 572.187326  , 659.71991666, 644.12505807,
        546.43393927, 499.66923691]),
 array([1.19763481, 1.58261284, 1.97590313, 2.25552416, 2.48876068,
        2.68221607, 2.84973263, 2.99823921, 3.13316311, 3.25813879]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kalman_forecast</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">res_intercept</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">][</span><span class="n">var</span><span class="p">]</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([129178.4624745 , 116851.03996239, 114039.69709622, 107319.08528989,
        102752.29796329,  97574.13385047,  93019.91763514,  88513.37562621,
         84299.771959  ,  80252.93121538]),
 array([ 1.3632964 ,  3.86830389,  5.54158214,  7.30596453,  8.79657816,
        10.19440725, 11.44143598, 12.58059511, 13.60954158, 14.54393827]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> res = search_arima(ap, period=12)
<span class="n">res</span><span class="p">[</span><span class="s1">&#39;arma&#39;</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/ubuntu/miniconda3/envs/arima/lib/python3.7/site-packages/ipykernel_launcher.py:4: RuntimeWarning: invalid value encountered in sqrt
  after removing the cwd from sys.path.
/home/ubuntu/miniconda3/envs/arima/lib/python3.7/site-packages/ipykernel_launcher.py:4: RuntimeWarning: invalid value encountered in sqrt
  after removing the cwd from sys.path.
/home/ubuntu/miniconda3/envs/arima/lib/python3.7/site-packages/ipykernel_launcher.py:4: RuntimeWarning: invalid value encountered in sqrt
  after removing the cwd from sys.path.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 6.69 s, sys: 7.26 ms, total: 6.69 s
Wall time: 6.69 s
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((0, 2, 1, 0, 12, 0, 0), 1291.4926822887805)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mstl</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data</th>
      <th>trend</th>
      <th>seasonal</th>
      <th>remainder</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>5.446245</td>
      <td>-4.446245</td>
      <td>2.664535e-15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5.446245</td>
      <td>-3.446245</td>
      <td>1.776357e-15</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>5.446245</td>
      <td>-2.446245</td>
      <td>1.776357e-15</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>5.446245</td>
      <td>-1.446245</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>5.446245</td>
      <td>-0.446245</td>
      <td>-8.881784e-16</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>5.446245</td>
      <td>0.553755</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>5.446245</td>
      <td>1.553755</td>
      <td>-8.881784e-16</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>5.446245</td>
      <td>2.553755</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>5.446245</td>
      <td>3.553755</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>5.446245</td>
      <td>4.553755</td>
      <td>-1.776357e-15</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seas_heuristic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nsdiffs</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ndiffs</span><span class="p">(</span><span class="n">ap</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">newmodel</span><span class="p">(</span><span class="o">*</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">results</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">newmodel</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="auto_arima_f" class="doc_header"><code>auto_arima_f</code><a href="https://github.com/Nixtla/statsforecast/tree/main/statsforecast/arima.py#L1400" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>auto_arima_f</code>(<strong><code>x</code></strong>, <strong><code>d</code></strong>=<em><code>None</code></em>, <strong><code>D</code></strong>=<em><code>None</code></em>, <strong><code>max_p</code></strong>=<em><code>5</code></em>, <strong><code>max_q</code></strong>=<em><code>5</code></em>, <strong><code>max_P</code></strong>=<em><code>2</code></em>, <strong><code>max_Q</code></strong>=<em><code>2</code></em>, <strong><code>max_order</code></strong>=<em><code>5</code></em>, <strong><code>max_d</code></strong>=<em><code>2</code></em>, <strong><code>max_D</code></strong>=<em><code>1</code></em>, <strong><code>start_p</code></strong>=<em><code>2</code></em>, <strong><code>start_q</code></strong>=<em><code>2</code></em>, <strong><code>start_P</code></strong>=<em><code>1</code></em>, <strong><code>start_Q</code></strong>=<em><code>1</code></em>, <strong><code>stationary</code></strong>=<em><code>False</code></em>, <strong><code>seasonal</code></strong>=<em><code>True</code></em>, <strong><code>ic</code></strong>=<em><code>'aicc'</code></em>, <strong><code>stepwise</code></strong>=<em><code>True</code></em>, <strong><code>nmodels</code></strong>=<em><code>94</code></em>, <strong><code>trace</code></strong>=<em><code>False</code></em>, <strong><code>approximation</code></strong>=<em><code>None</code></em>, <strong><code>method</code></strong>=<em><code>None</code></em>, <strong><code>truncate</code></strong>=<em><code>None</code></em>, <strong><code>xreg</code></strong>=<em><code>None</code></em>, <strong><code>test</code></strong>=<em><code>'kpss'</code></em>, <strong><code>test_kwargs</code></strong>=<em><code>None</code></em>, <strong><code>seasonal_test</code></strong>=<em><code>'seas'</code></em>, <strong><code>seasonal_test_kwargs</code></strong>=<em><code>None</code></em>, <strong><code>allowdrift</code></strong>=<em><code>True</code></em>, <strong><code>allowmean</code></strong>=<em><code>True</code></em>, <strong><code>blambda</code></strong>=<em><code>None</code></em>, <strong><code>biasadj</code></strong>=<em><code>False</code></em>, <strong><code>parallel</code></strong>=<em><code>False</code></em>, <strong><code>num_cores</code></strong>=<em><code>2</code></em>, <strong><code>period</code></strong>=<em><code>1</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> mod = auto_arima_f(ap, period=12, method=&#39;CSS-ML&#39;)
<span class="n">mod</span><span class="p">[</span><span class="s1">&#39;arma&#39;</span><span class="p">],</span> <span class="n">mod</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">],</span> <span class="n">mod</span><span class="p">[</span><span class="s1">&#39;coef&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 826 ms, sys: 205 µs, total: 826 ms
Wall time: 826 ms
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((1, 0, 0, 0, 12, 1, 1), 1020.4021744379531, {&#39;ar1&#39;: -0.30005076872006264})</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kalman_forecast</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">mod</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">][</span><span class="n">var</span><span class="p">]</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([444.30005077, 418.2100203 , 446.23703401, 488.22892853,
        499.23136059, 562.23063085, 649.23084981, 633.23078411,
        535.23080382, 488.23079791]),
 array([1.        , 1.48992893, 2.11399685, 2.69611394, 3.29066515,
        3.8814717 , 4.47340059, 5.06499261, 5.6566857 , 6.24834847]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="predict_arima" class="doc_header"><code>predict_arima</code><a href="https://github.com/Nixtla/statsforecast/tree/main/statsforecast/arima.py#L1864" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>predict_arima</code>(<strong><code>model</code></strong>, <strong><code>n_ahead</code></strong>, <strong><code>newxreg</code></strong>=<em><code>None</code></em>, <strong><code>se_fit</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predict_arima</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">se_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([119014.98431475, 112806.94929752, 120931.25144532, 133052.33768616,
       136226.90789209, 154408.53725334, 179516.50160936])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predict_arima</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([444.30005077, 418.2100203 , 446.23703401, 488.22892853,
        499.23136059, 562.23063085, 649.23084981]),
 array([11.7964303 , 14.39903482, 17.1515263 , 19.36955873, 21.39894941,
        23.24067931, 24.94993977]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predict_arima</span><span class="p">(</span><span class="n">res_intercept</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([129460.21014002, 117132.78762791, 114321.44476174, 107600.83295541,
        103034.04562881,  97855.88151599,  93301.66530066]),
 array([ 9275.872308  , 15624.99579589, 18701.50269012, 21473.28046921,
        23562.23590062, 25365.33522472, 26871.99340073]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

